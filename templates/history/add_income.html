{% extends 'base.html' %}

{% block title %}Add Income{% endblock %}

{% block content %}
<h1>Add Income</h1>
<form method="post" enctype="multipart/form-data" id="income-form">
    {% csrf_token %}
    <div>
        {{ form.amount.label_tag }}
        {{ form.amount }}
    </div>
    <div>
        <label for="income_type">Income Type</label>
        <div id="income-type-images">
            {% for income_type in income_types %}
            <div class="income-type-option">
                <input type="radio" id="income_type_{{ income_type.id }}" name="income_type" value="{{ income_type.id }}" style="display: none;">
                <label for="income_type_{{ income_type.id }}">
                    {% if income_type.image %}
                    <img src="{{ income_type.image.url }}" alt="{{ income_type.name }}" title="{{ income_type.name }}">
                    {% else %}
                    <span>{{ income_type.name }}</span>
                    {% endif %}
                </label>
            </div>
            {% endfor %}
        </div>
        <div>
            <label for="manual_income_type">Or Enter Income Type Manually</label>
            {{ form.manual_income_type }}
            <label for="manual_income_image">Upload Image for Manual Income Type</label>
            {{ form.manual_income_image }}
        </div>
    </div>
    <div>
        <label for="currency">Currency:</label>
        {{ form.currency }}
    </div>
    <div>
        <label for="payment_method">Payment Method:</label>
        {{ form.payment_method }}
    </div>
    <div>
        {{ form.image.label_tag }}
        {{ form.image }}
    </div>
    <div>
        {{ form.date.label_tag }}
        {{ form.date }}
    </div>
    <button type="submit">Add Income</button>
</form>
<a href="{% url 'index' %}">Back to Home</a>

<style>
    h1 {
        font-size: 2em;
        margin-bottom: 20px;
    }
    form {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        border: 1px solid #ccc;
        border-radius: 10px;
        background: #f9f9f9;
    }
    div {
        margin-bottom: 15px;
    }
    label {
        display: block;
        margin-bottom: 5px;
    }
    input[type="text"],
    input[type="date"],
    input[type="file"],
    select {
        width: 100%;
        padding: 8px;
        box-sizing: border-box;
        border: 1px solid #ccc;
        border-radius: 5px;
    }
    button {
        display: inline-block;
        padding: 10px 15px;
        font-size: 1em;
        color: #fff;
        background: #007bff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    button:hover {
        background: #0056b3;
    }
    a {
        display: inline-block;
        margin-top: 10px;
        text-decoration: none;
        color: #007bff;
    }
    a:hover {
        text-decoration: underline;
    }
    #income-type-images {
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }
    .income-type-option {
        display: inline-block;
        cursor: pointer;
    }
    .income-type-option img {
        border: 2px solid transparent;
        border-radius: 5px;
        width: 100px;
        height: 100px;
        object-fit: cover;
    }
    .income-type-option input[type="radio"]:checked + label img {
        border-color: #007bff;
    }
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const manualInput = document.getElementById('id_manual_income_type');
    const manualImageInput = document.getElementById('id_manual_income_image');
    const incomeTypeRadios = document.querySelectorAll('input[name="income_type"]');
    
    manualInput.addEventListener('input', function() {
        if (this.value.trim().length > 0) {
            incomeTypeRadios.forEach(radio => {
                radio.checked = false;
            });
        }
    });

    incomeTypeRadios.forEach(radio => {
        radio.addEventListener('change', function() {
            if (this.checked) {
                manualInput.value = '';
                manualImageInput.value = '';
            }
        });
    });
});
</script>
{% endblock %}
